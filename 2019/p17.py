#!/usr/bin/env python
# coding: utf-8

#       ............#############......................................
#       ............#...........#......................................
#       ............#.#############....................................
#       ............#.#.........#.#....................................
#       ............#.#.......#######..................................
#       ............#.#.........#.#.#..................................
#       ............#.#.........#.#.#.......................###########
#       ............#.#.........#.#.#.......................#.........#
#       ..###########.#.........#.#.#.......................#.........#
#       ..#...........#.........#.#.#.......................#.........#
#       #############.#.........#.#.#.......................#.........#
#       #.#.........#.#.........#.#.#.......................#.........#
#       #.#.........#.###########.###########.....###########.........#
#       #.#.........#...............#.......#.....#...................#
#       #.#.........#...............###########.###########...........#
#       #.#.........#.......................#.#.#.#.......#...........#
#       #.#.........#.......................#.#.#.#.......#...........#
#       #.#.........#.......................#.#.#.#.......#...........#
#       #.#.........#.......................#.#.#.#.......#.###########
#       #.#.........#.......................#.#.#.#.......#.#..........
#       #.###########.......................#.#.#.#.......#.#..........
#       #...................................#.#.#.#.......#.#..........
#       ########^...........................#######.......#.#..........
#       ......................................#.#.........#.#..........
#       ......................................#############.#..........
#       ........................................#...........#..........
#       ........................................#############..........

# path [L,8,R,12,R,12,R,10,R,10,R,12,R,10,L,8,R,12,R,12,R,10,R,10,R,12,R,10,L,10,R,10,L,6,L,10,R,10,L,6,R,10,R,12,R,10,L,8,R,12,R,12,R,10,R,10,R,12,R,10,L,10,R,10,L,6]

# path [A,B,A,B,C,C,B,A,B,C]
# L,8,R,12,R,12,R,10
# R,10,R,12,R,10
# L,10,R,10,L,6

from shared.intcode import *
import curses

# Main      
f = open('assets/17.txt', 'r')
intcode = [int(x) for x in f.read().rstrip().split(',')]

def make_room(raw):
    return [[z for z in y] for y in "".join([str(chr(x)) for x in raw]).split('\n') if y != '']

comp = Computer(intcode[:])
comp.run_program()
room = make_room(comp.outputs[:-1])
# for r in room:
#     print(''.join(r))

intersections = []
for j in range(1,len(room)-1):
    for i in range(1, len(room[j])-1):
        if room[j][i] == '#' and room[j-1][i] == '#' and room[j+1][i] == '#' and room[j][i-1] == '#' and room[j][i+1] == '#':
            intersections.append((i,j))

print(sum([x[0]*x[1] for x in intersections]))


# Part 2

def print_room(stdscr,room):
    for j in range(len(room)):
        for i in range(len(room[j])):
            stdscr.addstr(j, i, room[j][i])
    stdscr.getkey()

routines = []
routines.append([ord(x) for x in 'A,B,A,B,C,C,B,A,B,C\n'])
routines.append([ord(x) for x in 'L,8,R,12,R,12,R,10\n'])
routines.append([ord(x) for x in 'R,10,R,12,R,10\n'])
routines.append([ord(x) for x in 'L,10,R,10,L,6\n'])
routines.append([ord(x) for x in 'n\n'])

comp = Computer([2] + intcode[1:])

running = False
while True:
    comp.tick()
    if 'KILL' in comp.outputs:
        break

    if comp.waiting_input:
        comp.inputs = routines.pop(0)
        print("".join([str(chr(x)) for x in comp.inputs]))

    if comp.outputs:
        print(str(chr(comp.outputs.pop())), end='')

room = make_room(comp.outputs[:-2])
for r in room:
    print(''.join(r))
print()
print(comp.out_log[-1])